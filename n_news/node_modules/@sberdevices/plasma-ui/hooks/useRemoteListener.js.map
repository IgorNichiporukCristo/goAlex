{"version":3,"sources":["../src/hooks/useRemoteListener.ts"],"names":["navKeys","getRemoteKey","key","isLong","undefined","useRemoteListener","cb","keypressTimeMs","keydown","handleKeydown","event","Boolean","current","Date","now","remoteKey","handleKeyup","indexOf","window","addEventListener","removeEventListener"],"mappings":";;;;;;;AAAA;;AAOA,IAAMA,OAAO,GAAG,CAAC,SAAD,EAAY,WAAZ,EAAyB,WAAzB,EAAsC,YAAtC,EAAoD,OAApD,EAA6D,QAA7D,EAAuE,UAAvE,EAAmF,MAAnF,EAA2F,KAA3F,CAAhB;;AAEA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAcC,MAAd,EAAyD;AAC1E,UAAQD,GAAR;AACI,SAAK,SAAL;AACI,aAAOC,MAAM,GAAG,SAAH,GAAe,IAA5B;;AACJ,SAAK,WAAL;AACI,aAAOA,MAAM,GAAG,WAAH,GAAiB,MAA9B;;AACJ,SAAK,WAAL;AACI,aAAOA,MAAM,GAAG,WAAH,GAAiB,MAA9B;;AACJ,SAAK,YAAL;AACI,aAAOA,MAAM,GAAG,YAAH,GAAkB,OAA/B;;AACJ,SAAK,OAAL;AACI,aAAOA,MAAM,GAAG,SAAH,GAAe,IAA5B;;AACJ,SAAK,QAAL;AACI,aAAO,SAAP;;AACJ,SAAK,UAAL;AACI,aAAO,WAAP;;AACJ,SAAK,MAAL;AACI,aAAO,MAAP;;AACJ,SAAK,KAAL;AACI,aAAO,KAAP;;AACJ;AACI,aAAOC,SAAP;AApBR;AAsBH,CAvBD;AAyBA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACO,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,EAAD,EAA8E;AAAA,MAAzBC,cAAyB,uEAAR,GAAQ;AAC3G,MAAMC,OAAO,GAAG,mBAAsB,IAAtB,CAAhB;AAEA,wBAAU,YAAM;AACZ,QAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,KAAD,EAAgC;AAClD,UAAMP,MAAM,GAAGQ,OAAO,CAACH,OAAO,CAACI,OAAR,IAAmBC,IAAI,CAACC,GAAL,KAAaN,OAAO,CAACI,OAArB,GAA+BL,cAAnD,CAAtB;AACA,UAAMQ,SAAS,GAAGd,YAAY,CAACS,KAAK,CAACR,GAAP,EAAYC,MAAZ,CAA9B;;AAEA,UAAI,CAACY,SAAL,EAAgB;AACZ;AACH;;AAEDT,MAAAA,EAAE,CAACS,SAAD,EAAYL,KAAZ,CAAF;AACAF,MAAAA,OAAO,CAACI,OAAR,GAAkBC,IAAI,CAACC,GAAL,EAAlB;AACH,KAVD;;AAWA,QAAME,WAAW,GAAG,SAAdA,WAAc,CAACN,KAAD,EAAgC;AAChD,UAAIV,OAAO,CAACiB,OAAR,CAAgBP,KAAK,CAACR,GAAtB,MAA+B,CAAC,CAApC,EAAuC;AACnC;AACH;;AACDM,MAAAA,OAAO,CAACI,OAAR,GAAkB,IAAlB;AACH,KALD;;AAOAM,IAAAA,MAAM,CAACC,gBAAP,CAAwB,SAAxB,EAAmCV,aAAnC;AACAS,IAAAA,MAAM,CAACC,gBAAP,CAAwB,OAAxB,EAAiCH,WAAjC;AAEA,WAAO,YAAM;AACTE,MAAAA,MAAM,CAACE,mBAAP,CAA2B,SAA3B,EAAsCX,aAAtC;AACAS,MAAAA,MAAM,CAACE,mBAAP,CAA2B,OAA3B,EAAoCJ,WAApC;AACH,KAHD;AAIH,GA1BD,EA0BG,CAACV,EAAD,CA1BH;AA2BH,CA9BM","sourcesContent":["import { useEffect, useRef } from 'react';\n\ntype ShortKey = 'UP' | 'DOWN' | 'LEFT' | 'RIGHT' | 'OK';\ntype LongKey = 'LONG_UP' | 'LONG_DOWN' | 'LONG_LEFT' | 'LONG_RIGHT' | 'LONG_OK';\ntype JumpKey = 'PAGE_UP' | 'PAGE_DOWN' | 'HOME' | 'END';\nexport type RemoteKey = ShortKey | LongKey | JumpKey;\n\nconst navKeys = ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'Enter', 'PageUp', 'PageDown', 'Home', 'End'];\n\nconst getRemoteKey = (key: string, isLong: boolean): RemoteKey | undefined => {\n    switch (key) {\n        case 'ArrowUp':\n            return isLong ? 'LONG_UP' : 'UP';\n        case 'ArrowDown':\n            return isLong ? 'LONG_DOWN' : 'DOWN';\n        case 'ArrowLeft':\n            return isLong ? 'LONG_LEFT' : 'LEFT';\n        case 'ArrowRight':\n            return isLong ? 'LONG_RIGHT' : 'RIGHT';\n        case 'Enter':\n            return isLong ? 'LONG_OK' : 'OK';\n        case 'PageUp':\n            return 'PAGE_UP';\n        case 'PageDown':\n            return 'PAGE_DOWN';\n        case 'Home':\n            return 'HOME';\n        case 'End':\n            return 'END';\n        default:\n            return undefined;\n    }\n};\n\n/**\n * Создает слушателя событий клавиатуры,\n * который вызывает коллбек при нажатии кнопок навигации.\n * @param {Function} cb\n * @param {number} keypressTimeMs\n * @return {void}\n */\nexport const useRemoteListener = (cb: (key: RemoteKey, event: KeyboardEvent) => void, keypressTimeMs = 150) => {\n    const keydown = useRef<number | null>(null);\n\n    useEffect(() => {\n        const handleKeydown = (event: KeyboardEvent): void => {\n            const isLong = Boolean(keydown.current && Date.now() - keydown.current < keypressTimeMs);\n            const remoteKey = getRemoteKey(event.key, isLong);\n\n            if (!remoteKey) {\n                return;\n            }\n\n            cb(remoteKey, event);\n            keydown.current = Date.now();\n        };\n        const handleKeyup = (event: KeyboardEvent): void => {\n            if (navKeys.indexOf(event.key) === -1) {\n                return;\n            }\n            keydown.current = null;\n        };\n\n        window.addEventListener('keydown', handleKeydown);\n        window.addEventListener('keyup', handleKeyup);\n\n        return () => {\n            window.removeEventListener('keydown', handleKeydown);\n            window.removeEventListener('keyup', handleKeyup);\n        };\n    }, [cb]);\n};\n"],"file":"useRemoteListener.js"}