{"version":3,"sources":["../../../src/components/Slider/Handle.tsx"],"names":["React","styled","Draggable","surfaceLiquid03","white","handleDiameter","handleBorderWidth","HandleStyled","div","getValue","handleCenterXRelative","stepSize","min","max","newValue","Math","round","getOffsets","ref","side","current","size","clientWidth","clientLeft","Handle","forwardRef","onChangeCommitted","onChange","xPosition","bounds","zIndex","disabled","lastOnChangeValue","useRef","onDrag","useCallback","_","data","newHandleXPosition","lastX","onStop","offsetLeft","offsetRight","leftValueBound","rightValueBound","leftPositionBound","rightPositionBound","left","right","x","y","undefined"],"mappings":"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","sourcesContent":["import React from 'react';\nimport styled from 'styled-components';\nimport Draggable, { DraggableData } from 'react-draggable';\nimport { surfaceLiquid03, white } from '@sberdevices/plasma-tokens';\n\nimport { handleDiameter, handleBorderWidth } from './SliderBase';\n\ninterface HandleProps {\n    stepSize: number;\n    min: number;\n    max: number;\n    side?: 'left' | 'right';\n    bounds?: number[];\n    xPosition?: number;\n    zIndex?: number;\n    disabled?: boolean;\n    onChangeCommitted(value: number, data: DraggableData): void;\n    onChange?(value: number, data: DraggableData): void;\n}\n\nconst HandleStyled = styled.div`\n    cursor: pointer;\n    position: absolute;\n    z-index: 100;\n    top: 0;\n    left: 0;\n    border-radius: 50%;\n    background-color: ${white};\n    width: ${handleDiameter}rem;\n    height: ${handleDiameter}rem;\n    border: ${handleBorderWidth}rem solid ${surfaceLiquid03};\n    background-clip: content-box;\n`;\n\nfunction getValue(handleCenterXRelative: number, stepSize: number, min: number, max: number) {\n    const newValue = Math.round(handleCenterXRelative / stepSize) + min;\n\n    return Math.min(Math.max(newValue, min), max);\n}\n\nfunction getOffsets(\n    ref: ((instance: HTMLDivElement | null) => void) | React.MutableRefObject<HTMLDivElement | null> | null,\n    side?: 'left' | 'right',\n) {\n    if (!ref || !('current' in ref) || !ref.current || !side) {\n        return [0, 0];\n    }\n\n    const size = ref.current.clientWidth - ref.current.clientLeft;\n\n    if (side === 'left') {\n        return [0, size];\n    }\n\n    if (side === 'right') {\n        return [size, 0];\n    }\n\n    return [0, 0];\n}\n\nexport const Handle = React.forwardRef<HTMLDivElement, HandleProps>(\n    ({ stepSize, onChangeCommitted, onChange, xPosition, min, max, bounds = [], zIndex, disabled, side }, ref) => {\n        const lastOnChangeValue = React.useRef<number | null>(null);\n\n        const onDrag = React.useCallback(\n            (_, data) => {\n                const newHandleXPosition = data.lastX;\n\n                if (onChange) {\n                    const newValue = getValue(newHandleXPosition, stepSize, min, max);\n                    if (lastOnChangeValue.current !== newValue) {\n                        onChange(newValue, data);\n                        lastOnChangeValue.current = newValue;\n                    }\n                }\n            },\n            [onChange, stepSize, min, max],\n        );\n\n        const onStop = React.useCallback(\n            (_, data) => {\n                const newHandleXPosition = data.lastX;\n                const newValue = getValue(newHandleXPosition, stepSize, min, max);\n                onChangeCommitted(newValue, data);\n            },\n            [onChangeCommitted, stepSize, min, max],\n        );\n\n        const [offsetLeft, offsetRight] = getOffsets(ref, side);\n\n        const [leftValueBound, rightValueBound] = bounds;\n        const leftPositionBound = leftValueBound ? (leftValueBound - min) * stepSize : null;\n        const rightPositionBound = rightValueBound ? (rightValueBound - min) * stepSize : null;\n\n        return (\n            <Draggable\n                axis=\"x\"\n                bounds={{\n                    left: (leftPositionBound ?? 0) + offsetLeft,\n                    right: (rightPositionBound ?? stepSize * (max - min)) - offsetRight,\n                }}\n                grid={[stepSize, 1]}\n                onStop={onStop}\n                onDrag={onDrag}\n                position={typeof xPosition === 'number' ? { x: xPosition, y: 0 } : undefined}\n                disabled={disabled}\n            >\n                <HandleStyled ref={ref} style={{ zIndex }} />\n            </Draggable>\n        );\n    },\n);\n"],"file":"Handle.js"}